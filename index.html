<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>La Tiendita CR by Gaby</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- Top bar -->
  <div class="topbar">
    <div class="topbar__inner">
      <span>ðŸ‡ºðŸ‡¸ SelecciÃ³n original â€¢ ðŸ‡¨ðŸ‡· Entrega en Costa Rica</span>
      <a class="topbar__link" href="https://wa.me/TU_NUMERO" target="_blank" rel="noopener">WhatsApp</a>
    </div>
  </div>

  <!-- Header / Hero -->
  <header class="hero">
    <div class="hero__content">

      <div class="hero__brandRow">
        <div class="brand">
          <!-- Logo principal -->
          <div class="brand__logoWrap">
            <img class="brand__logo" src="images/logo.jpeg" alt="La Tiendita CR by Gaby" />
          </div>

          <div class="brand__text">
            <h1 class="brand__name">La Tiendita CR</h1>
            <p class="brand__tag">by Gaby â€¢ Marcas originales seleccionadas en USA</p>

            <div class="hero__cta">
              <a class="btn btn--primary" href="#catalogo">Ver catÃ¡logo</a>
              <a class="btn btn--ghost" href="LINK_A_TU_GOOGLE_FORM" target="_blank" rel="noopener">Hacer encargo</a>
            </div>
          </div>
        </div>

        <div class="hero__meta">
          <div class="meta-card">
            <div class="meta-title">Entrega</div>
            <div class="meta-value">Coordinada / MensajerÃ­a</div>
          </div>
          <div class="meta-card">
            <div class="meta-title">Origen</div>
            <div class="meta-value">Compras en USA</div>
          </div>
          <div class="meta-card">
            <div class="meta-title">Reservas</div>
            <div class="meta-value">WhatsApp</div>
          </div>
        </div>
      </div>

    </div>
  </header>

  <!-- Catalog -->
  <main class="container" id="catalogo">
    <section class="section-head">
      <h2>Productos disponibles</h2>
      <p>ArtÃ­culos originales con entrega inmediata en Costa Rica. Reserva por WhatsApp.</p>

      <div class="stats">
        <div class="stats__item">
          <span class="dot dot--ok"></span>
          <span><b id="countAvailable">0</b> disponibles</span>
        </div>
        <div class="stats__item">
          <span class="dot dot--gold"></span>
          <span><b id="countLastUnits">0</b> Ãºltima(s) unidad(es)</span>
        </div>
        <div class="stats__item">
          <span class="dot dot--muted"></span>
          <span><b id="countTotal">0</b> producto(s)</span>
        </div>
      </div>
    </section>

    <!-- Categories -->
    <section class="filters" aria-label="Filtros de categorÃ­a">
      <button class="chip active" data-filter="all" type="button">Todo</button>
      <button class="chip" data-filter="bolsos" type="button">Bolsos</button>
      <button class="chip" data-filter="carteras" type="button">Carteras</button>
      <button class="chip" data-filter="accesorios" type="button">Accesorios</button>
      <button class="chip" data-filter="zapatos" type="button">Zapatos</button>
      <button class="chip" data-filter="ropa" type="button">Ropa</button>
    </section>

    <!-- Products grid -->
    <section class="grid" id="grid">

      <!-- PRODUCTO 1 -->
      <article class="card"
               data-category="bolsos"
               data-status="available"
               data-stock="2"
               data-name="Bolso Tommy Hilfiger"
               data-details="Color: Azul â€¢ TamaÃ±o: Mediano"
               data-price="59000"
               data-oldprice="69000"
               data-image="images/bolso_azul_tommy_1-O.webp">
        <div class="card__media">
          <img src="images/bolso_azul_tommy_1-O.webp" alt="Bolso Tommy Hilfiger" loading="lazy" />
          <span class="badge badge--ok">Disponible</span>
        </div>

        <div class="card__body">
          <div class="card__title">Bolso Tommy Hilfiger</div>
          <div class="card__sub">Color: Azul â€¢ TamaÃ±o: Mediano</div>

          <div class="price">
            <div class="price__now">â‚¡59,000</div>
            <div class="price__was">â‚¡69,000</div>
            <div class="price__off">-14%</div>
          </div>

          <button class="btn btn--primary btn--full js-open" type="button">Ver detalles</button>
        </div>
      </article>

      <!-- PRODUCTO 2 (Ãºltima unidad por stock=1) -->
      <article class="card"
               data-category="bolsos"
               data-status="available"
               data-stock="1"
               data-name="Bolso Steve Madden"
               data-details="Color: Negro â€¢ TamaÃ±o: Mediano"
               data-price="59000"
               data-oldprice=""
               data-image="images/bolso_steve_maiden_negro.jpg">
        <div class="card__media">
          <img src="images/bolso_steve_maiden_negro.jpg" alt="Bolso Steve Madden" loading="lazy" />
          <span class="badge badge--ok">Disponible</span>
          <!-- <span class="badge badge--last">Ãšltima unidad</span> -->
        </div>

        <div class="card__body">
          <div class="card__title">Bolso Steve Madden</div>
          <div class="card__sub">Color: Negro â€¢ TamaÃ±o: Mediano</div>

          <div class="price">
            <div class="price__now">â‚¡59,000</div>
          </div>

          <button class="btn btn--primary btn--full js-open" type="button">Ver detalles</button>
        </div>
      </article>

      <!-- PRODUCTO 3 (vendido) -->
      <article class="card"
               data-category="zapatos"
               data-status="sold"
               data-stock="0"
               data-name="Tenis Steve Madden"
               data-details="Color: Blanco â€¢ Talla: US 10"
               data-price="65000"
               data-oldprice="75000"
               data-image="images/Tenis_steve_maiden.webp">
        <div class="card__media">
          <img src="images/Tenis_steve_maiden.webp" alt="Tenis Steve Madden" loading="lazy" />
          <span class="badge badge--sold">Vendido</span>
        </div>

        <div class="card__body">
          <div class="card__title">Tenis Steve Madden</div>
          <div class="card__sub">Color: Blanco â€¢ Talla: US 10</div>

          <div class="price">
            <div class="price__now">â‚¡65,000</div>
            <div class="price__was">â‚¡75,000</div>
            <div class="price__off">-13%</div>
          </div>

          <button class="btn btn--disabled btn--full" type="button" disabled>No disponible</button>
        </div>
      </article>

      <!-- AGREGA MÃS PRODUCTOS COPIANDO UNA CARD -->
    </section>

    <!-- Custom order -->
    <section class="callout">
      <div>
        <h3>Â¿Buscas algo especÃ­fico?</h3>
        <p>Haz tu encargo personalizado (bolsos, tenis, ropa y accesorios). Te cotizamos por WhatsApp.</p>
      </div>
      <a class="btn btn--gold" href="LINK_A_TU_GOOGLE_FORM" target="_blank" rel="noopener">Hacer encargo</a>
    </section>
  </main>

  <!-- Floating WhatsApp -->
  <a class="whatsapp-float" href="https://wa.me/TU_NUMERO" target="_blank" rel="noopener" aria-label="WhatsApp">
    WhatsApp
  </a>

  <footer class="footer">
    <p>Â© 2026 La Tiendita CR by Gaby â€¢ Marcas originales seleccionadas en Estados Unidos</p>
  </footer>

  <!-- Modal -->
  <div class="modal" id="productModal" aria-hidden="true">
    <div class="modal__backdrop" data-close="true"></div>

    <div class="modal__panel" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <button class="modal__close" type="button" data-close="true" aria-label="Cerrar">âœ•</button>

      <div class="modal__grid">
        <div class="modal__media">
          <img id="modalImg" src="" alt="" />
        </div>

        <div class="modal__content">
          <div class="modal__badges">
            <span id="modalBadgeStatus" class="badge badge--ok">Disponible</span>
            <span id="modalBadgeLast" class="badge badge--last" style="display:none;">Ãšltima unidad</span>
          </div>

          <h3 class="modal__title" id="modalTitle">Producto</h3>
          <p class="modal__sub" id="modalSub">Detalle</p>

          <div class="modal__price">
            <div class="price">
              <div class="price__now" id="modalPriceNow">â‚¡0</div>
              <div class="price__was" id="modalPriceWas" style="display:none;">â‚¡0</div>
              <div class="price__off" id="modalPriceOff" style="display:none;">-0%</div>
            </div>

            <div class="stock">
              <span class="stock__label">Stock:</span>
              <span class="stock__value" id="modalStock">0</span>
            </div>
          </div>

          <div class="modal__actions">
            <a class="btn btn--primary btn--full" id="modalWhatsApp" href="#" target="_blank" rel="noopener">
              Reservar por WhatsApp
            </a>
            <a class="btn btn--ghost btn--full" href="LINK_A_TU_GOOGLE_FORM" target="_blank" rel="noopener">
              Hacer encargo
            </a>
          </div>

          <p class="modal__note">
            *Disponibilidad sujeta a existencias. Reservas por WhatsApp.
          </p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===== Helpers =====
    const fmtCRC = (n) => {
      const val = Number(n || 0);
      return "â‚¡" + val.toLocaleString("es-CR");
    };

    const calcOff = (price, old) => {
      price = Number(price || 0);
      old = Number(old || 0);
      if (!old || old <= price) return null;
      const pct = Math.round(((old - price) / old) * 100);
      return pct > 0 ? pct : null;
    };

    // ===== Elements =====
    const chips = document.querySelectorAll(".chip");
    const grid = document.getElementById("grid");
    const cards = Array.from(document.querySelectorAll(".card"));

    const countAvailable = document.getElementById("countAvailable");
    const countLastUnits = document.getElementById("countLastUnits");
    const countTotal = document.getElementById("countTotal");

    // Modal elements
    const modal = document.getElementById("productModal");
    const modalImg = document.getElementById("modalImg");
    const modalTitle = document.getElementById("modalTitle");
    const modalSub = document.getElementById("modalSub");
    const modalStock = document.getElementById("modalStock");
    const modalBadgeStatus = document.getElementById("modalBadgeStatus");
    const modalBadgeLast = document.getElementById("modalBadgeLast");

    const modalPriceNow = document.getElementById("modalPriceNow");
    const modalPriceWas = document.getElementById("modalPriceWas");
    const modalPriceOff = document.getElementById("modalPriceOff");
    const modalWhatsApp = document.getElementById("modalWhatsApp");

    // ===== Init: normalize last unit badge and offer labels =====
    cards.forEach((card, i) => {
      // Animations stagger
      card.style.animationDelay = (i * 55) + "ms";
      card.classList.add("reveal");

      const stock = Number(card.dataset.stock || 0);
      const status = (card.dataset.status || "available").toLowerCase();

      // Ensure "Ãºltima unidad" badge exists only when needed
      const media = card.querySelector(".card__media");
      const hasLast = media.querySelector(".badge--last");
      if (stock === 1 && status !== "sold" && !hasLast) {
        const b = document.createElement("span");
        b.className = "badge badge--last";
        b.textContent = "Ãšltima unidad";
        media.appendChild(b);
      }
      if (stock !== 1 && hasLast) hasLast.remove();

      // Offer calculation display (if oldprice exists)
      const price = Number(card.dataset.price || 0);
      const old = Number(card.dataset.oldprice || 0);
      const off = calcOff(price, old);

      const priceWrap = card.querySelector(".price");
      if (priceWrap) {
        const nowEl = priceWrap.querySelector(".price__now");
        const wasEl = priceWrap.querySelector(".price__was");
        const offEl = priceWrap.querySelector(".price__off");

        if (nowEl) nowEl.textContent = fmtCRC(price);

        if (!old || old <= price) {
          if (wasEl) wasEl.style.display = "none";
          if (offEl) offEl.style.display = "none";
        } else {
          if (wasEl) { wasEl.textContent = fmtCRC(old); wasEl.style.display = ""; }
          if (offEl && off != null) { offEl.textContent = "-" + off + "%"; offEl.style.display = ""; }
        }
      }

      // Sold state if stock=0
      if (stock <= 0 || status === "sold") {
        card.dataset.status = "sold";
        const badgeOk = card.querySelector(".badge--ok");
        if (badgeOk) badgeOk.remove();
        const badgeSold = card.querySelector(".badge--sold");
        if (!badgeSold) {
          const b = document.createElement("span");
          b.className = "badge badge--sold";
          b.textContent = "Vendido";
          media.appendChild(b);
        }
        const btn = card.querySelector(".js-open");
        if (btn) {
          btn.className = "btn btn--disabled btn--full";
          btn.textContent = "No disponible";
          btn.disabled = true;
        }
      }
    });

    // ===== Filtering + counters =====
    let currentFilter = "all";

    function isVisibleByFilter(card) {
      const category = card.dataset.category;
      return (currentFilter === "all" || category === currentFilter);
    }

    function refreshCounters() {
      const visible = cards.filter(c => c.style.display !== "none" && isVisibleByFilter(c));
      const available = visible.filter(c => (c.dataset.status || "available") !== "sold" && Number(c.dataset.stock || 0) > 0);
      const lastUnits = available.filter(c => Number(c.dataset.stock || 0) === 1);

      countTotal.textContent = visible.length;
      countAvailable.textContent = available.length;
      countLastUnits.textContent = lastUnits.length;
    }

    function applyFilter(filter) {
      currentFilter = filter;

      cards.forEach(card => {
        const category = card.dataset.category;
        const show = (filter === "all" || category === filter);
        card.style.display = show ? "" : "none";
      });

      refreshCounters();
    }

    chips.forEach(chip => {
      chip.addEventListener("click", () => {
        chips.forEach(c => c.classList.remove("active"));
        chip.classList.add("active");
        applyFilter(chip.dataset.filter);
      });
    });

    // ===== Modal logic =====
    function openModalFromCard(card) {
      const name = card.dataset.name || card.querySelector(".card__title")?.textContent?.trim() || "Producto";
      const details = card.dataset.details || card.querySelector(".card__sub")?.textContent?.trim() || "";
      const img = card.dataset.image || card.querySelector("img")?.getAttribute("src") || "";
      const price = Number(card.dataset.price || 0);
      const old = Number(card.dataset.oldprice || 0);
      const off = calcOff(price, old);

      const stock = Number(card.dataset.stock || 0);
      const status = (card.dataset.status || "available").toLowerCase();

      modalImg.src = img;
      modalImg.alt = name;
      modalTitle.textContent = name;
      modalSub.textContent = details;

      modalPriceNow.textContent = fmtCRC(price);

      if (old && old > price) {
        modalPriceWas.textContent = fmtCRC(old);
        modalPriceWas.style.display = "";
        if (off != null) {
          modalPriceOff.textContent = "-" + off + "%";
          modalPriceOff.style.display = "";
        } else {
          modalPriceOff.style.display = "none";
        }
      } else {
        modalPriceWas.style.display = "none";
        modalPriceOff.style.display = "none";
      }

      modalStock.textContent = stock;

      // badges
      if (status === "sold" || stock <= 0) {
        modalBadgeStatus.className = "badge badge--sold";
        modalBadgeStatus.textContent = "Vendido";
      } else {
        modalBadgeStatus.className = "badge badge--ok";
        modalBadgeStatus.textContent = "Disponible";
      }

      modalBadgeLast.style.display = (stock === 1 && status !== "sold") ? "" : "none";

      // WhatsApp link
      const msg = encodeURIComponent(`Hola, quiero reservar: ${name} (${fmtCRC(price)}) â€” La Tiendita CR by Gaby`);
      modalWhatsApp.href = `https://wa.me/TU_NUMERO?text=${msg}`;

      // disable WhatsApp if sold
      if (status === "sold" || stock <= 0) {
        modalWhatsApp.classList.add("btn--disabled");
        modalWhatsApp.setAttribute("aria-disabled", "true");
        modalWhatsApp.onclick = (e) => e.preventDefault();
      } else {
        modalWhatsApp.classList.remove("btn--disabled");
        modalWhatsApp.removeAttribute("aria-disabled");
        modalWhatsApp.onclick = null;
      }

      modal.classList.add("is-open");
      modal.setAttribute("aria-hidden", "false");
      document.body.classList.add("no-scroll");
    }

    // open modal on card or button click
    grid.addEventListener("click", (e) => {
      const btn = e.target.closest(".js-open");
      const card = e.target.closest(".card");
      if (btn && card && !btn.disabled) openModalFromCard(card);
      else if (card && !e.target.closest("a,button") && (card.dataset.status || "available") !== "sold") {
        // click anywhere on card (except buttons/links)
        openModalFromCard(card);
      }
    });

    // close modal
    modal.addEventListener("click", (e) => {
      if (e.target.dataset.close === "true") closeModal();
    });

    function closeModal() {
      modal.classList.remove("is-open");
      modal.setAttribute("aria-hidden", "true");
      document.body.classList.remove("no-scroll");
    }

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && modal.classList.contains("is-open")) closeModal();
    });

    // Initial counters
    applyFilter("all");
  </script>
</body>
</html>
